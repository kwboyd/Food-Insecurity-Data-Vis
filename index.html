<html>
    <head>
        <title>High Charts Hello World!</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" >

    </head>
    <body>
        <div id="map" style="width:100%; height: 600px;">

            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
              <li role="presentation" class="active"><a href="#2000" aria-controls="2000" role="tab" data-toggle="tab">Home</a></li>
              <li role="presentation"><a href="#2007" aria-controls="2007" role="tab" data-toggle="tab">Profile</a></li>
              <li role="presentation"><a href="#2010" aria-controls="2010" role="tab" data-toggle="tab">Messages</a></li>
              <li role="presentation"><a href="#2013" aria-controls="2012" role="tab" data-toggle="tab">Settings</a></li>
            </ul>
          
            <!-- Tab panes -->
            <div class="tab-content">
              <div role="tabpanel" class="tab-pane active" id="2000">
                  <table id="map1"></table>
              </div>
              <div role="tabpanel" class="tab-pane" id="2007">...</div>
              <div role="tabpanel" class="tab-pane" id="2010">...</div>
              <div role="tabpanel" class="tab-pane" id="2012">...</div>
            </div>

        </div>
        <div id="bar" style="width:100%; height:400px;"></div>

        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <script>
            
           var householdTypes = [];
           var average = [];
           var couples = [];
           var female = [];
           var male = [];
           var state = [];
           var stateName = [];
           var twoThousand = [];
           var twoThousandSeven = [];
           var twoThousandTen = [];
           var twoThousandTwelve = [];
           var mapCount = 1;
           var table00 = [];
            function loadData () {
                $.ajax({
                    url: 'familystructure.xml',
                    type: 'GET',
                    dataType: 'xml',
                    success: function(xml){
                        parseData(xml)
                    }
                });
                            
            }
           
           function parseData (xml) {
    
            
                $(xml).find("household").each(function(index){
                    householdTypes.push($(this).attr("name"));
                    average.push(parseFloat($(this).find("average").text()));
                    couples.push(parseFloat($(this).find("couple").text()));
                    male.push(parseFloat($(this).find("male").text()));
                    female.push(parseFloat($(this).find("female").text()));
                });
                
                buildChart();
                buildMap(xml);
                
           }
            
            function buildMap(xml) {
                $(xml).find("state").each(function(index){
                    table00 += "<tr><td>" + mapCount + "</td>";
                    mapCount ++;
                    table00 += "<td>" + ($(this).find("statename").text()) + "</td>";
                    table00 += "<td>" + parseFloat($(this).find("twothousand").text()) + "</td></tr>";
                    $('map1').append(table00);
    
                }
            )}
            
        
            
            function buildChart() { 
                $('#bar').highcharts({
                    chart: {
                        type: 'bar'
                    },
                    title: {
                        text: 'Percent of Households that are Food Insecure'
                    },
                    subtitle: {
                        text: 'Organized by Family Structure'
                    },
                    xAxis: {
                        categories: householdTypes
                    },
                    yAxis: {
                        title: {
                            text: 'Percent'
                        }
                    },
                    series: [{
                        name: 'Average',
                        data: average
                    }, {
                        name: 'Couples',
                        data: couples
                    }, {
                        name: 'Single Females',
                        data: female
                    }, {
                        name: 'Single Males',
                        data: male
                    }]
                });
            };
            
            $(document).ready(function(){
                console.log("doc ready!")
                loadData();
            })
        </script>
    </body>
</html>